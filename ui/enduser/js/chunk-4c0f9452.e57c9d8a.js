/*!
 * Copyright 2019-2020 ForgeRock AS. All Rights Reserved 
 *  Use of this code requires a commercial software license with ForgeRock AS. or with one of its affiliates. All use shall be exclusively subject to such license between the licensee and ForgeRock AS.
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4c0f9452"],{"0075":function(e,t,i){},"0bad":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.passwordVerification||e.socialVerification?i("fr-center-card",{attrs:{showLogo:!0}},[i("div",{attrs:{slot:"center-card-header"},slot:"center-card-header"},[i("h2",{staticClass:"h2"},[e._v(e._s(e.$t("pages.selfservice.accountClaiming.title")))]),e.passwordVerification?i("span",{domProps:{innerHTML:e._s(e.$t("pages.selfservice.accountClaiming.passwordDesc",{account:e.mail}))}}):e._e(),e.socialVerification?i("span",[e._v(e._s(e.socialDescription))]):e._e()]),i("b-card-body",{attrs:{slot:"center-card-body"},slot:"center-card-body"},[e.passwordVerification?i("fr-floating-label-input",{attrs:{label:e.$t("pages.login.password"),reveal:!0,type:"password",fieldName:"password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}):e._e(),e.socialVerification?i("fr-social-buttons",{attrs:{filterProviders:e.providers,filterProvidersObjects:e.providersObjects,signin:""}}):e._e(),e.passwordVerification?i("button",{staticClass:"btn btn-lg btn-primary btn-block mb-3",attrs:{type:"button"},on:{click:e.claimAccount}},[e._v(e._s(e.$t("pages.login.signIn")))]):e._e()],1),i("b-card-footer",{attrs:{slot:"center-card-footer"},slot:"center-card-footer"},[i("router-link",{attrs:{action:"",to:"login"}},[e._v(e._s(e.$t("pages.selfservice.accountClaiming.return")))])],1)],1):i("b-container",{staticClass:"h-100 px-0",attrs:{fluid:""}},[i("div",{staticClass:"h-100 d-flex"},[i("div",{staticClass:"m-auto fr-center-card"},[i("bounce-loader",{attrs:{color:e.loadingColor}})],1)])])},o=[],r=i("2ef0"),a=i.n(r),n=i("b107"),c=i.n(n),l=i("8455"),u=i("13bf"),d=i("49c6"),f=i("e5d2"),p=i("3fd4"),g={components:{BounceLoader:l["BounceLoader"],"fr-center-card":u["a"],"fr-floating-label-input":d["a"],"fr-social-buttons":p["a"]},data:function(){return{apiType:"socialUserClaim",loadingColor:c.a.baseColor,selfServiceDetails:{},password:"",passwordVerification:!1,socialVerification:!1,providers:[],providersObjects:[],mail:""}},mixins:[f["a"]],name:"Account-Claiming",props:["clientToken","originalToken","returnParams"],mounted:function(){if(localStorage.getItem("accountClaimingToken")){var e=atob(localStorage.getItem("accountClaimingToken"));localStorage.removeItem("accountClaimingToken"),this.claimAccount(e)}else this.loadData()},computed:{socialDescription:function(){var e=this,t=this.providers.length,i="";return a.a.each(this.providers,(function(s,o){i+=1===t?a.a.upperFirst(s):o<t-2?"".concat(a.a.upperFirst(s),", "):o<t-1?"".concat(a.a.upperFirst(s)," "):" ".concat(e.$t("pages.selfservice.social.or")," ").concat(a.a.upperFirst(s))})),this.$t("pages.selfservice.accountClaiming.socialDesc",{providers:i})}},methods:{claimAccount:function(e){var t=this.clientToken;a.a.isString(e)&&(t=e),this.advanceStage({clientToken:t,password:this.password})},apiErrorCallback:function(e){this.$router.push("/login"),this.displayNotification("error",e.response.data.message)},setChildComponent:function(e,t){var i=this;if(this.selfServiceDetails=t,"parameters"===e)this.returnParams?this.advanceStage({returnParams:this.returnParams}):this.advanceStage({});else if("socialUserClaim"===e&&"initial"===t.tag)this.advanceStage({clientToken:this.clientToken});else if("socialUserClaim"===e&&"verifyProfile"===t.tag)this.mail=a.a.has(t,"requirements.mail")?t.requirements.mail:"",t.requirements.error?this.displayNotification("error",t.requirements.error.message):-1!==t.requirements.required.indexOf("password")?this.passwordVerification=!0:this.clientToken&&this.originalToken?this.advanceStage({clientToken:this.originalToken}):(localStorage.setItem("accountClaimingToken",btoa(this.clientToken)),this.providers=a.a.map(t.requirements.definitions.providers.items.oneOf,"provider"),this.providersObjects=t.requirements.definitions.providers.items.oneOf,this.socialVerification=!0);else if("localAutoLogin"===e&&a.a.isUndefined(t.additions.claimedProfile))this.$router.push({name:"Registration",params:{clientToken:this.clientToken}});else if("end"===t.tag&&t.status.success){var s=this.getRequestService({headers:{"X-OpenIDM-NoSession":"false","X-OpenIDM-OAuth-Login":"true","X-OpenIDM-DataStoreToken":this.clientToken,"X-Requested-With":"XMLHttpRequest"}});s.post("/authentication?_action=login").then((function(e){i.progressiveProfileCheck(e,(function(){a.a.has(t,"additions.successUrl")&&!a.a.isEmpty(t.additions.successUrl)?window.location=t.additions.successUrl:i.$router.push("/"),i.displayNotification("success",i.$t("pages.selfservice.accountClaiming.linked"))}))})).catch((function(e){i.$router.push("/login"),i.displayNotification("error",e.response.data.message)}))}else this.$router.push("/login"),this.displayNotification("error",this.$t("pages.selfservice.accountClaiming.error"))}}},h=g,v=i("2877"),m=Object(v["a"])(h,s,o,!1,null,"d915cd8e",null);t["default"]=m.exports},"3fd4":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.providers.length?i("div",[e._l(e.filteredProviders,(function(t,s){return i("button",{key:s,staticClass:"btn btn-lg btn-light btn-block fr-btn-social mb-3",style:e.socialButtonStyles[s],attrs:{type:"button"},on:{click:function(i){return e.goToIDP(t.provider)},mouseover:function(i){return e.hover(s,t.uiConfig.buttonCustomStyleHover)},mouseout:function(i){return e.hover(s,t.uiConfig.buttonCustomStyle)}}},[t.uiConfig.buttonImage?i("img",{attrs:{src:"static/"+t.uiConfig.buttonImage}}):i("i",{class:["fab fa-lg",t.uiConfig.iconClass]}),e.signin?i("span",{staticClass:"ml-1"},[e._v(e._s(e.$t("pages.selfservice.social.signIn"))+" "+e._s(t.uiConfig.buttonDisplayName))]):i("span",{staticClass:"ml-1"},[e._v(e._s(e.$t("pages.selfservice.social.signUp"))+" "+e._s(t.uiConfig.buttonDisplayName))])])})),0===this.filterProviders.length?i("div",{staticClass:"fr-form-break text-muted mb-3"},[i("div"),i("div",[e._v(e._s(e.$t("pages.selfservice.social.or")))]),i("div")]):e._e()],2):e._e()},o=[],r=i("2ef0"),a=i.n(r),n={name:"Social-Buttons",props:{signin:{type:Boolean,default:!1},filterProviders:{type:Array,default:function(){return[]}},filterProvidersObjects:{type:Array,default:function(){return[]}}},computed:{filteredProviders:function(){return a.a.filter(this.providers,(function(e){return e.uiConfig}))}},data:function(){return{providers:[],socialButtonStyles:[]}},mounted:function(){this.loadData()},methods:{loadData:function(){var e=this,t=this.getRequestService({headers:this.getAnonymousHeaders()});t.get("/authentication").then((function(t){e.providers=a.a.filter(t.data.providers||[],(function(t,i){if(0===e.filterProviders.length||a.a.includes(e.filterProviders,t.provider))return!0})),e.providers.length?a.a.each(e.providers,(function(t,i){e.$set(e.socialButtonStyles,i,t.uiConfig.buttonCustomStyle),"salesforce"===t.provider&&(t.uiConfig.iconClass="fa-salesforce")})):e.filterProvidersObjects.length&&(e.providers=e.filterProvidersObjects)})).catch((function(t){e.displayNotification("error",t.response.data.message)}))},hover:function(e,t){this.$set(this.socialButtonStyles,e,t)},goToIDP:function(e){var t=this,i=this.getRequestService({headers:this.getAnonymousHeaders()});i.post("/authentication?_action=logout").then((function(){i.post("/identityProviders?_action=getAuthRedirect",{provider:e,landingPage:"".concat(window.location.protocol,"/").concat(window.location.host,"/#/login?_oauthReturn=true&provider=").concat(e,"&gotoURL=%23")}).then((function(e){localStorage.setItem("dataStoreToken",btoa(e.data.token)),window.location.href=e.data.redirect})).catch((function(e){t.displayNotification("error",e.response.data.message)}))})).catch((function(e){t.displayNotification("error",e.response.data.message)}))}}},c=n,l=(i("eb3e"),i("2877")),u=Object(l["a"])(c,s,o,!1,null,"74a5e4cc",null);t["a"]=u.exports},eb3e:function(e,t,i){"use strict";i("0075")}}]);
//# sourceMappingURL=chunk-4c0f9452.e57c9d8a.js.map