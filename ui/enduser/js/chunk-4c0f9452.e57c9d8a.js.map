{"version":3,"sources":["webpack:///./src/components/selfservice/registration/AccountClaiming.vue?eaab","webpack:///src/components/selfservice/registration/AccountClaiming.vue","webpack:///./src/components/selfservice/registration/AccountClaiming.vue?c4b7","webpack:///./src/components/selfservice/registration/AccountClaiming.vue","webpack:///./src/components/utils/SocialButtons.vue?3d6a","webpack:///src/components/utils/SocialButtons.vue","webpack:///./src/components/utils/SocialButtons.vue?8929","webpack:///./src/components/utils/SocialButtons.vue?6cd8","webpack:///./src/components/utils/SocialButtons.vue?34fd"],"names":["render","_vm","this","_h","$createElement","_c","_self","passwordVerification","socialVerification","attrs","slot","staticClass","_v","_s","$t","domProps","account","mail","_e","socialDescription","model","value","callback","$$v","password","expression","providers","providersObjects","on","claimAccount","loadingColor","staticRenderFns","components","BounceLoader","data","apiType","selfServiceDetails","mixins","SelfserviceAPI","name","props","mounted","localStorage","computed","providerList","_","methods","accountClaimingToken","clientToken","apiErrorCallback","error","setChildComponent","type","details","params","headers","socialLoginInstance","then","window","catch","component","_l","provider","index","key","style","socialButtonStyles","$event","goToIDP","hover","uiConfig","buttonCustomStyleHover","buttonCustomStyle","buttonImage","class","iconClass","buttonDisplayName","filterProviders","length","default","filteredProviders","loadData","socialInstance"],"mappings":"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","file":"js/chunk-4c0f9452.e57c9d8a.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (!_vm.passwordVerification && !_vm.socialVerification)?_c('b-container',{staticClass:\"h-100 px-0\",attrs:{\"fluid\":\"\"}},[_c('div',{staticClass:\"h-100 d-flex\"},[_c('div',{staticClass:\"m-auto fr-center-card\"},[_c('bounce-loader',{attrs:{\"color\":_vm.loadingColor}})],1)])]):_c('fr-center-card',{attrs:{\"showLogo\":true}},[_c('div',{attrs:{\"slot\":\"center-card-header\"},slot:\"center-card-header\"},[_c('h2',{staticClass:\"h2\"},[_vm._v(_vm._s(_vm.$t(\"pages.selfservice.accountClaiming.title\")))]),(_vm.passwordVerification)?_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.$t('pages.selfservice.accountClaiming.passwordDesc', {account: _vm.mail}))}}):_vm._e(),(_vm.socialVerification)?_c('span',[_vm._v(_vm._s(_vm.socialDescription))]):_vm._e()]),_c('b-card-body',{attrs:{\"slot\":\"center-card-body\"},slot:\"center-card-body\"},[(_vm.passwordVerification)?_c('fr-floating-label-input',{attrs:{\"label\":_vm.$t('pages.login.password'),\"reveal\":true,\"type\":\"password\",\"fieldName\":\"password\"},model:{value:(_vm.password),callback:function ($$v) {_vm.password=$$v},expression:\"password\"}}):_vm._e(),(_vm.socialVerification)?_c('fr-social-buttons',{attrs:{\"filterProviders\":_vm.providers,\"filterProvidersObjects\":_vm.providersObjects,\"signin\":\"\"}}):_vm._e(),(_vm.passwordVerification)?_c('button',{staticClass:\"btn btn-lg btn-primary btn-block mb-3\",attrs:{\"type\":\"button\"},on:{\"click\":_vm.claimAccount}},[_vm._v(_vm._s(_vm.$t(\"pages.login.signIn\")))]):_vm._e()],1),_c('b-card-footer',{attrs:{\"slot\":\"center-card-footer\"},slot:\"center-card-footer\"},[_c('router-link',{attrs:{\"action\":\"\",\"to\":\"login\"}},[_vm._v(_vm._s(_vm.$t(\"pages.selfservice.accountClaiming.return\")))])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!--\nCopyright (c) 2020-2021 ForgeRock. All rights reserved.\n\nThis software may be modified and distributed under the terms\nof the MIT license. See the LICENSE file for details.\n-->\n\n<template>\n    <b-container fluid class=\"h-100 px-0\" v-if=\"!passwordVerification && !socialVerification\">\n        <div class=\"h-100 d-flex\">\n            <div class=\"m-auto fr-center-card\">\n                <bounce-loader :color=\"loadingColor\"></bounce-loader>\n            </div>\n        </div>\n    </b-container>\n\n    <fr-center-card :showLogo=\"true\" v-else>\n        <div slot=\"center-card-header\">\n            <h2 class=\"h2\">{{$t(\"pages.selfservice.accountClaiming.title\")}}</h2>\n            <span v-if=\"passwordVerification\" v-html=\"$t('pages.selfservice.accountClaiming.passwordDesc', {account: mail})\"></span>\n            <span v-if=\"socialVerification\">{{socialDescription}}</span>\n        </div>\n\n        <b-card-body slot=\"center-card-body\">\n            <fr-floating-label-input v-if=\"passwordVerification\"\n                v-model=\"password\"\n                :label=\"$t('pages.login.password')\"\n                :reveal=\"true\"\n                type=\"password\"\n                fieldName=\"password\"></fr-floating-label-input>\n\n            <fr-social-buttons v-if=\"socialVerification\" :filterProviders=\"providers\" :filterProvidersObjects=\"providersObjects\" signin></fr-social-buttons>\n\n            <button v-if=\"passwordVerification\"\n                v-on:click=\"claimAccount\"\n                class=\"btn btn-lg btn-primary btn-block mb-3\"\n                type=\"button\">{{$t(\"pages.login.signIn\")}}</button>\n        </b-card-body>\n\n        <b-card-footer slot=\"center-card-footer\">\n            <router-link action=\"\" to=\"login\">{{$t(\"pages.selfservice.accountClaiming.return\")}}</router-link>\n        </b-card-footer>\n    </fr-center-card>\n</template>\n\n<script>\nimport _ from 'lodash';\nimport styles from '@/scss/main.scss';\nimport { BounceLoader } from 'vue-spinner/dist/vue-spinner.min.js';\nimport CenterCard from '@/components/utils/CenterCard';\nimport FloatingLabelInput from '@/components/utils/FloatingLabelInput';\nimport SelfserviceAPI from '@/components/selfservice/mixins/SelfserviceAPIMixin';\nimport SocialButtons from '@/components/utils/SocialButtons';\n\nexport default {\n    components: {\n        BounceLoader,\n        'fr-center-card': CenterCard,\n        'fr-floating-label-input': FloatingLabelInput,\n        'fr-social-buttons': SocialButtons\n    },\n    data () {\n        return {\n            apiType: 'socialUserClaim',\n            loadingColor: styles.baseColor,\n            selfServiceDetails: {},\n            password: '',\n            passwordVerification: false,\n            socialVerification: false,\n            providers: [],\n            providersObjects: [],\n            mail: ''\n        };\n    },\n    mixins: [\n        SelfserviceAPI\n    ],\n    name: 'Account-Claiming',\n    props: ['clientToken', 'originalToken', 'returnParams'],\n    mounted () {\n        if (localStorage.getItem('accountClaimingToken')) {\n            let accountClaimingToken = atob(localStorage.getItem('accountClaimingToken'));\n\n            localStorage.removeItem('accountClaimingToken');\n\n            this.claimAccount(accountClaimingToken);\n        } else {\n            /* istanbul ignore next */\n            this.loadData();\n        }\n    },\n    computed: {\n        socialDescription () {\n            let numProviders = this.providers.length,\n                providerList = '';\n\n            _.each(this.providers, (provider, index) => {\n                if (numProviders === 1) {\n                    providerList += _.upperFirst(provider);\n                } else if (index < numProviders - 2) {\n                    providerList += `${_.upperFirst(provider)}, `;\n                } else if (index < numProviders - 1) {\n                    providerList += `${_.upperFirst(provider)} `;\n                } else {\n                    providerList += ` ${this.$t('pages.selfservice.social.or')} ${_.upperFirst(provider)}`;\n                }\n            });\n\n            return this.$t('pages.selfservice.accountClaiming.socialDesc', { providers: providerList });\n        }\n    },\n    methods: {\n        claimAccount (accountClaimingToken) {\n            let clientToken = this.clientToken;\n\n            if (_.isString(accountClaimingToken)) {\n                clientToken = accountClaimingToken;\n            }\n            /* istanbul ignore next */\n            this.advanceStage({\n                'clientToken': clientToken,\n                'password': this.password\n            });\n        },\n        apiErrorCallback (error) {\n            /* istanbul ignore next */\n            this.$router.push('/login');\n            /* istanbul ignore next */\n            this.displayNotification('error', error.response.data.message);\n        },\n        setChildComponent (type, details) {\n            /* istanbul ignore next */\n            this.selfServiceDetails = details;\n            /* istanbul ignore next */\n            if (type === 'parameters') {\n                if (this.returnParams) {\n                    this.advanceStage({\n                        'returnParams': this.returnParams\n                    });\n                } else {\n                    this.advanceStage({});\n                }\n            } else if (type === 'socialUserClaim' && details.tag === 'initial') {\n                this.advanceStage({\n                    'clientToken': this.clientToken\n                });\n            } else if (type === 'socialUserClaim' && details.tag === 'verifyProfile') {\n                this.mail = _.has(details, 'requirements.mail') ? details.requirements.mail : '';\n\n                if (details.requirements.error) {\n                    this.displayNotification('error', details.requirements.error.message);\n                } else if (details.requirements.required.indexOf('password') !== -1) {\n                    // You can get into this usecase by\n                    // having a manually registered account with matching email and a password set\n                    this.passwordVerification = true;\n                } else {\n                    if (this.clientToken && this.originalToken) {\n                        this.advanceStage({\n                            'clientToken': this.originalToken\n                        });\n                    } else {\n                        localStorage.setItem('accountClaimingToken', btoa(this.clientToken));\n                        this.providers = _.map(details.requirements.definitions.providers.items.oneOf, 'provider');\n                        this.providersObjects = details.requirements.definitions.providers.items.oneOf;\n                        this.socialVerification = true;\n                    }\n                }\n            } else if (type === 'localAutoLogin' && _.isUndefined(details.additions.claimedProfile)) {\n                this.$router.push({ name: 'Registration', params: { clientToken: this.clientToken } });\n            } else if (details.tag === 'end' && details.status.success) {\n                const socialLoginInstance = this.getRequestService({\n                    headers: {\n                        'X-OpenIDM-NoSession': 'false',\n                        'X-OpenIDM-OAuth-Login': 'true',\n                        'X-OpenIDM-DataStoreToken': this.clientToken,\n                        'X-Requested-With': 'XMLHttpRequest'\n                    }\n                });\n\n                socialLoginInstance.post('/authentication?_action=login')\n                    .then((userDetails) => {\n                        // Check for progressive profiling.\n                        this.progressiveProfileCheck(userDetails, () => {\n                            if (_.has(details, 'additions.successUrl') && !_.isEmpty(details.additions.successUrl)) {\n                                window.location = details.additions.successUrl;\n                            } else {\n                                this.$router.push('/');\n                            }\n                            this.displayNotification('success', this.$t('pages.selfservice.accountClaiming.linked'));\n                        });\n                    })\n                    .catch((error) => {\n                        this.$router.push('/login');\n                        this.displayNotification('error', error.response.data.message);\n                    });\n            } else {\n                this.$router.push('/login');\n                this.displayNotification('error', this.$t('pages.selfservice.accountClaiming.error'));\n            }\n        }\n    }\n};\n</script>\n\n<style scoped></style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AccountClaiming.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AccountClaiming.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AccountClaiming.vue?vue&type=template&id=d915cd8e&scoped=true&\"\nimport script from \"./AccountClaiming.vue?vue&type=script&lang=js&\"\nexport * from \"./AccountClaiming.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d915cd8e\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.providers.length)?_c('div',[_vm._l((_vm.filteredProviders),function(provider,index){return _c('button',{key:index,staticClass:\"btn btn-lg btn-light btn-block fr-btn-social mb-3\",style:(_vm.socialButtonStyles[index]),attrs:{\"type\":\"button\"},on:{\"click\":function($event){return _vm.goToIDP(provider.provider)},\"mouseover\":function($event){return _vm.hover(index, provider.uiConfig.buttonCustomStyleHover)},\"mouseout\":function($event){return _vm.hover(index, provider.uiConfig.buttonCustomStyle)}}},[(provider.uiConfig.buttonImage)?_c('img',{attrs:{\"src\":'static/' + provider.uiConfig.buttonImage}}):_c('i',{class:['fab fa-lg', provider.uiConfig.iconClass]}),(_vm.signin)?_c('span',{staticClass:\"ml-1\"},[_vm._v(_vm._s(_vm.$t(\"pages.selfservice.social.signIn\"))+\" \"+_vm._s(provider.uiConfig.buttonDisplayName))]):_c('span',{staticClass:\"ml-1\"},[_vm._v(_vm._s(_vm.$t(\"pages.selfservice.social.signUp\"))+\" \"+_vm._s(provider.uiConfig.buttonDisplayName))])])}),(this.filterProviders.length === 0)?_c('div',{staticClass:\"fr-form-break text-muted mb-3\"},[_c('div'),_c('div',[_vm._v(_vm._s(_vm.$t(\"pages.selfservice.social.or\")))]),_c('div')]):_vm._e()],2):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<!--\nCopyright (c) 2020-2021 ForgeRock. All rights reserved.\n\nThis software may be modified and distributed under the terms\nof the MIT license. See the LICENSE file for details.\n-->\n\n<template>\n    <div v-if=\"providers.length\">\n        <button class=\"btn btn-lg btn-light btn-block fr-btn-social mb-3\"\n            type=\"button\"\n            v-for=\"(provider, index) in filteredProviders\"\n            :key=\"index\"\n            :style=\"socialButtonStyles[index]\"\n            @click=\"goToIDP(provider.provider)\"\n            @mouseover=\"hover(index, provider.uiConfig.buttonCustomStyleHover)\"\n            @mouseout=\"hover(index, provider.uiConfig.buttonCustomStyle)\">\n\n            <img v-if=\"provider.uiConfig.buttonImage\" :src=\"'static/' + provider.uiConfig.buttonImage\"/>\n            <i v-else :class=\"['fab fa-lg', provider.uiConfig.iconClass]\"></i>\n\n            <span class=\"ml-1\" v-if=\"signin\">{{$t(\"pages.selfservice.social.signIn\")}} {{provider.uiConfig.buttonDisplayName}}</span>\n            <span class=\"ml-1\" v-else>{{$t(\"pages.selfservice.social.signUp\")}} {{provider.uiConfig.buttonDisplayName}}</span>\n        </button>\n\n        <div class=\"fr-form-break text-muted mb-3\" v-if=\"this.filterProviders.length === 0\">\n            <div></div>\n            <div>{{$t(\"pages.selfservice.social.or\")}}</div>\n            <div></div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport _ from 'lodash';\n\n/**\n* @description Controlling component for initializing oauth process for login and registration.\n* This component controls the displaying of the buttons based on which providers are configured.\n*\n* @fires GET authentication - Returns a list of available configured providers.\n* @fires POST identityProviders?_action=getAuthRedirect - Generates the redirect URL used to go to the selected provider and begin the Oauth authentication process\n*\n**/\nexport default {\n    name: 'Social-Buttons',\n    props: {\n        'signin': {\n            type: Boolean,\n            default: false\n        },\n        'filterProviders': {\n            type: Array,\n            default: () => { return []; }\n        },\n        'filterProvidersObjects': {\n            type: Array,\n            default: () => { return []; }\n        }\n    },\n    computed: {\n        filteredProviders () {\n            return _.filter(this.providers, (provider) => { return provider.uiConfig; });\n        }\n    },\n    data () {\n        return {\n            providers: [],\n            socialButtonStyles: []\n        };\n    },\n    mounted () {\n        /* istanbul ignore next */\n        this.loadData();\n    },\n    methods: {\n        loadData () {\n            /* istanbul ignore next */\n            const socialInstance = this.getRequestService({\n                headers: this.getAnonymousHeaders()\n            });\n                /* istanbul ignore next */\n            socialInstance.get('/authentication')\n                .then((response) => {\n                    this.providers = _.filter(response.data.providers || [], (provider, index) => {\n                        if (this.filterProviders.length === 0 || _.includes(this.filterProviders, provider.provider)) {\n                            return true;\n                        }\n                    });\n\n                    if (this.providers.length) {\n                        _.each(this.providers, (provider, index) => {\n                            this.$set(this.socialButtonStyles, index, provider.uiConfig.buttonCustomStyle);\n\n                            if (provider.provider === 'salesforce') {\n                                provider.uiConfig.iconClass = 'fa-salesforce';\n                            }\n                        });\n                    } else if (this.filterProvidersObjects.length) {\n                        this.providers = this.filterProvidersObjects;\n                    }\n                })\n                .catch((error) => {\n                    this.displayNotification('error', error.response.data.message);\n                });\n        },\n        hover (index, style) {\n            this.$set(this.socialButtonStyles, index, style);\n        },\n        goToIDP (provider) {\n            /* istanbul ignore next */\n            const socialInstance = this.getRequestService({\n                headers: this.getAnonymousHeaders()\n            });\n\n            /* istanbul ignore next */\n            socialInstance.post('/authentication?_action=logout').then(() => {\n                /* istanbul ignore next */\n                socialInstance.post('/identityProviders?_action=getAuthRedirect', {\n                    'provider': provider,\n                    'landingPage': `${window.location.protocol}/${window.location.host}/#/login?_oauthReturn=true&provider=${provider}&gotoURL=%23`\n                })\n                    .then((response) => {\n                        localStorage.setItem('dataStoreToken', btoa(response.data.token));\n                        window.location.href = response.data.redirect;\n                    })\n                    .catch((error) => {\n                        /* istanbul ignore next */\n                        this.displayNotification('error', error.response.data.message);\n                    });\n            })\n                .catch((error) => {\n                    /* istanbul ignore next */\n                    this.displayNotification('error', error.response.data.message);\n                });\n        }\n    }\n};\n</script>\n\n<style type=\"scss\" scoped>\n    .fr-btn-social img{\n        max-width: 21px;\n        margin-right: 5px;\n    }\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SocialButtons.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SocialButtons.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SocialButtons.vue?vue&type=template&id=74a5e4cc&scoped=true&\"\nimport script from \"./SocialButtons.vue?vue&type=script&lang=js&\"\nexport * from \"./SocialButtons.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SocialButtons.vue?vue&type=style&index=0&id=74a5e4cc&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"74a5e4cc\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SocialButtons.vue?vue&type=style&index=0&id=74a5e4cc&scoped=true&lang=css&\""],"sourceRoot":""}